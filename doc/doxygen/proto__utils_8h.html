<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Loganon: /home/taron/GSOC/loganon/lib/parser/proto_utils.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>/home/taron/GSOC/loganon/lib/parser/proto_utils.h File Reference</h1><code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;netinet/ip.h&gt;</code><br>
<code>#include &lt;netinet/udp.h&gt;</code><br>
<code>#include &lt;netinet/tcp.h&gt;</code><br>

<p>
<a href="proto__utils_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#162e1d5056eae66ae89a18e8b3f276ee">GET_IP_HEADER</a>(pkt, ip_hdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve IP header from packet.  <a href="#162e1d5056eae66ae89a18e8b3f276ee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#504e9fced2cf7dbb647f1c5629f160c7">GET_UDP_HEADER</a>(ip_hdr, udp_hdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve UDP header from IP header.  <a href="#504e9fced2cf7dbb647f1c5629f160c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#b99d7f09e0ef1447e70b7c446adbd845">GET_TCP_HEADER</a>(ip_hdr, tcp_hdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve TCP header from IP header.  <a href="#b99d7f09e0ef1447e70b7c446adbd845"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#f607f4945e4045b8cefac9135ab70128">GET_ETHERTYPE</a>(pkt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve EtherType field from ethernet datagrams.  <a href="#f607f4945e4045b8cefac9135ab70128"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#17c9653f49d32bdad044d7ccde52c9f1">GET_IPSRC</a>(pkt, off)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve IP_src field from IP datagram off is computed according to EtherType.  <a href="#17c9653f49d32bdad044d7ccde52c9f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#4a1c56c203217298ea42225facc49186">GET_IPDST</a>(pkt, off)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve IP_dst field from IP datagram off is computed according to EtherType.  <a href="#4a1c56c203217298ea42225facc49186"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#5222751d480c637420c8ce5d7b76ef16">ADDR_LONG_TO_STR</a>(ip_addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Network conversion from long to string.  <a href="#5222751d480c637420c8ce5d7b76ef16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#83f8f631470cc998287e7e94e38d4c29">ADDR_STR_TO_LONG</a>(ip_addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Network conversion from long to string.  <a href="#83f8f631470cc998287e7e94e38d4c29"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#fdfa4c71ef5f91c201fd151125179e20">GET_16_WORD</a>(buff, off)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a 16-bits word.  <a href="#fdfa4c71ef5f91c201fd151125179e20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#71459eef24735ae3085f29e7454688ea">GET_8_WORD</a>(buff, off)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a 16-bits word.  <a href="#71459eef24735ae3085f29e7454688ea"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#61a8e2c9705e0c7000235c60639f3f97">ETHER_TYPE_IP</a>&nbsp;&nbsp;&nbsp;0x0800</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">EtherType values.  <a href="#61a8e2c9705e0c7000235c60639f3f97"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto__utils_8h.html#ffc544c38c7e83941d75aca13e0ceb1b">ETHER_TYPE_8021Q</a>&nbsp;&nbsp;&nbsp;0x8100</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="5222751d480c637420c8ce5d7b76ef16"></a><!-- doxytag: member="proto_utils.h::ADDR_LONG_TO_STR" ref="5222751d480c637420c8ce5d7b76ef16" args="(ip_addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADDR_LONG_TO_STR          </td>
          <td>(</td>
          <td class="paramtype">ip_addr&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        inet_ntoa(*((<span class="keyword">struct</span> in_addr *)&amp;ip_addr))
</pre></div>Network conversion from long to string. 
<p>

</div>
</div><p>
<a class="anchor" name="83f8f631470cc998287e7e94e38d4c29"></a><!-- doxytag: member="proto_utils.h::ADDR_STR_TO_LONG" ref="83f8f631470cc998287e7e94e38d4c29" args="(ip_addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADDR_STR_TO_LONG          </td>
          <td>(</td>
          <td class="paramtype">ip_addr&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        inet_addr(ip_addr)
</pre></div>Network conversion from long to string. 
<p>

</div>
</div><p>
<a class="anchor" name="ffc544c38c7e83941d75aca13e0ceb1b"></a><!-- doxytag: member="proto_utils.h::ETHER_TYPE_8021Q" ref="ffc544c38c7e83941d75aca13e0ceb1b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ETHER_TYPE_8021Q&nbsp;&nbsp;&nbsp;0x8100          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="61a8e2c9705e0c7000235c60639f3f97"></a><!-- doxytag: member="proto_utils.h::ETHER_TYPE_IP" ref="61a8e2c9705e0c7000235c60639f3f97" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ETHER_TYPE_IP&nbsp;&nbsp;&nbsp;0x0800          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
EtherType values. 
<p>

</div>
</div><p>
<a class="anchor" name="fdfa4c71ef5f91c201fd151125179e20"></a><!-- doxytag: member="proto_utils.h::GET_16_WORD" ref="fdfa4c71ef5f91c201fd151125179e20" args="(buff, off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_16_WORD          </td>
          <td>(</td>
          <td class="paramtype">buff,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        *((uint16_t *)buff + off)
</pre></div>Get a 16-bits word. 
<p>

</div>
</div><p>
<a class="anchor" name="71459eef24735ae3085f29e7454688ea"></a><!-- doxytag: member="proto_utils.h::GET_8_WORD" ref="71459eef24735ae3085f29e7454688ea" args="(buff, off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_8_WORD          </td>
          <td>(</td>
          <td class="paramtype">buff,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        *((uint8_t *)buff + off)
</pre></div>Get a 16-bits word. 
<p>

</div>
</div><p>
<a class="anchor" name="f607f4945e4045b8cefac9135ab70128"></a><!-- doxytag: member="proto_utils.h::GET_ETHERTYPE" ref="f607f4945e4045b8cefac9135ab70128" args="(pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_ETHERTYPE          </td>
          <td>(</td>
          <td class="paramtype">pkt&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        ((uint16_t)(pkt[12]) &lt;&lt; 8) | (uint16_t)pkt[13]
</pre></div>Retrieve EtherType field from ethernet datagrams. 
<p>

</div>
</div><p>
<a class="anchor" name="162e1d5056eae66ae89a18e8b3f276ee"></a><!-- doxytag: member="proto_utils.h::GET_IP_HEADER" ref="162e1d5056eae66ae89a18e8b3f276ee" args="(pkt, ip_hdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_IP_HEADER          </td>
          <td>(</td>
          <td class="paramtype">pkt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ip_hdr&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        uint16_t ether_type = <a class="code" href="proto__utils_8h.html#f607f4945e4045b8cefac9135ab70128" title="Retrieve EtherType field from ethernet datagrams.">GET_ETHERTYPE</a>(pkt);       \
                                                                \
        <span class="keywordflow">if</span>(ether_type == <a class="code" href="proto__utils_8h.html#61a8e2c9705e0c7000235c60639f3f97" title="EtherType values.">ETHER_TYPE_IP</a>)         \
                ip_hdr = (<span class="keyword">struct </span>ip *)(pkt + 14);       \
                                                                \
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ether_type == <a class="code" href="proto__utils_8h.html#ffc544c38c7e83941d75aca13e0ceb1b">ETHER_TYPE_8021Q</a>) \
                ip_hdr = (<span class="keyword">struct </span>ip *)(pkt + 18);       \
        <span class="keywordflow">else</span>                                                    \
                assert(0);
</pre></div>Retrieve IP header from packet. 
<p>

</div>
</div><p>
<a class="anchor" name="4a1c56c203217298ea42225facc49186"></a><!-- doxytag: member="proto_utils.h::GET_IPDST" ref="4a1c56c203217298ea42225facc49186" args="(pkt, off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_IPDST          </td>
          <td>(</td>
          <td class="paramtype">pkt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        &amp;(((<span class="keyword">struct </span>ip*)(pkt+off+4))-&gt;ip_src)
</pre></div>Retrieve IP_dst field from IP datagram off is computed according to EtherType. 
<p>

</div>
</div><p>
<a class="anchor" name="17c9653f49d32bdad044d7ccde52c9f1"></a><!-- doxytag: member="proto_utils.h::GET_IPSRC" ref="17c9653f49d32bdad044d7ccde52c9f1" args="(pkt, off)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_IPSRC          </td>
          <td>(</td>
          <td class="paramtype">pkt,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        &amp;(((<span class="keyword">struct </span>ip*)(pkt+off))-&gt;ip_src)
</pre></div>Retrieve IP_src field from IP datagram off is computed according to EtherType. 
<p>

</div>
</div><p>
<a class="anchor" name="b99d7f09e0ef1447e70b7c446adbd845"></a><!-- doxytag: member="proto_utils.h::GET_TCP_HEADER" ref="b99d7f09e0ef1447e70b7c446adbd845" args="(ip_hdr, tcp_hdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_TCP_HEADER          </td>
          <td>(</td>
          <td class="paramtype">ip_hdr,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tcp_hdr&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        <span class="keywordflow">if</span>(ip_hdr-&gt;ip_p == IPPROTO_TCP)                                                         \
                tcp_hdr = (<span class="keyword">struct </span>tcphdr *)((uint32_t *)ip_hdr+ip_header-&gt;ip_hl);       \
        <span class="keywordflow">else</span>                                                                                            \
                assert(0);
</pre></div>Retrieve TCP header from IP header. 
<p>

</div>
</div><p>
<a class="anchor" name="504e9fced2cf7dbb647f1c5629f160c7"></a><!-- doxytag: member="proto_utils.h::GET_UDP_HEADER" ref="504e9fced2cf7dbb647f1c5629f160c7" args="(ip_hdr, udp_hdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_UDP_HEADER          </td>
          <td>(</td>
          <td class="paramtype">ip_hdr,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">udp_hdr&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">\
        <span class="keywordflow">if</span>(ip_hdr-&gt;ip_p == IPPROTO_UDP)                                                         \
                udp_hdr = (<span class="keyword">struct </span>udphdr *)((uint32_t *)ip_hdr+ip_header-&gt;ip_hl);       \
        <span class="keywordflow">else</span>                                                                                            \
                assert(0);
</pre></div>Retrieve UDP header from IP header. 
<p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Aug 15 18:27:28 2010 for Loganon by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
